"use strict";(globalThis.webpackChunkbook=globalThis.webpackChunkbook||[]).push([[3924],{2087:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>t,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"module-1/ch1-ros2-basics/topics","title":"Topics - Publish and Subscribe","description":"Estimated Reading Time: 8 minutes","source":"@site/docs/module-1/ch1-ros2-basics/02-topics.md","sourceDirName":"module-1/ch1-ros2-basics","slug":"/module-1/ch1-ros2-basics/topics","permalink":"/physical-ai-textbook/docs/module-1/ch1-ros2-basics/topics","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/module-1/ch1-ros2-basics/02-topics.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Topics - Publish and Subscribe"},"sidebar":"tutorialSidebar","previous":{"title":"Nodes and the Graph","permalink":"/physical-ai-textbook/docs/module-1/ch1-ros2-basics/nodes"},"next":{"title":"Services - Request and Response","permalink":"/physical-ai-textbook/docs/module-1/ch1-ros2-basics/services"}}');var i=n(4848),l=n(8453);const c={title:"Topics - Publish and Subscribe"},o="Section 2: Topics - Publish and Subscribe",t={},a=[{value:"The Problem with Direct Communication",id:"the-problem-with-direct-communication",level:2},{value:"\u274c Direct Connection (Bad)",id:"-direct-connection-bad",level:3},{value:"\u2705 Topic-Based (Good)",id:"-topic-based-good",level:3},{value:"What is a Topic?",id:"what-is-a-topic",level:2},{value:"Publishers and Subscribers",id:"publishers-and-subscribers",level:2},{value:"Publisher Node",id:"publisher-node",level:3},{value:"Subscriber Node",id:"subscriber-node",level:3},{value:"Code Example 2: Publisher/Subscriber System",id:"code-example-2-publishersubscriber-system",level:2},{value:"Publisher Node",id:"publisher-node-1",level:3},{value:"Subscriber Node",id:"subscriber-node-1",level:3},{value:"Running a Pub/Sub System",id:"running-a-pubsub-system",level:2},{value:"Terminal 1: Publisher",id:"terminal-1-publisher",level:3},{value:"Terminal 2: Subscriber",id:"terminal-2-subscriber",level:3},{value:"Terminal 3: Inspect the Graph",id:"terminal-3-inspect-the-graph",level:3},{value:"Topic Naming Conventions",id:"topic-naming-conventions",level:2},{value:"Message Types",id:"message-types",level:2},{value:"Quality of Service (QoS)",id:"quality-of-service-qos",level:2},{value:"Key Takeaways",id:"key-takeaways",level:2},{value:"Try It Yourself",id:"try-it-yourself",level:2},{value:"Next",id:"next",level:2}];function d(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",input:"input",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"section-2-topics---publish-and-subscribe",children:"Section 2: Topics - Publish and Subscribe"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Estimated Reading Time"}),": 8 minutes\r\n",(0,i.jsx)(s.strong,{children:"Bloom's Level"}),": Understand, Apply\r\n",(0,i.jsx)(s.strong,{children:"Key Learning"}),": One-to-many communication with decoupled nodes"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"the-problem-with-direct-communication",children:"The Problem with Direct Communication"}),"\n",(0,i.jsx)(s.p,{children:"Imagine you have a sensor node and a control node. How should they talk?"}),"\n",(0,i.jsx)(s.h3,{id:"-direct-connection-bad",children:"\u274c Direct Connection (Bad)"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"Sensor Node \u2192 Control Node\n"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Problems"}),":"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Control node must exist before sensor starts"}),"\n",(0,i.jsx)(s.li,{children:"Sensor knows about control (tight coupling)"}),"\n",(0,i.jsx)(s.li,{children:"Hard to add a second control node"}),"\n",(0,i.jsx)(s.li,{children:"If control crashes, sensor can't publish elsewhere"}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"-topic-based-good",children:"\u2705 Topic-Based (Good)"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"Sensor Node \u2192 [Topic: /data] \u2190 Control Node\r\n              \u2197 Logger Node\r\n              \u2197 Visualizer Node\n"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Benefits"}),":"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Nodes don't know about each other (decoupled)"}),"\n",(0,i.jsx)(s.li,{children:"Multiple nodes can listen (one-to-many)"}),"\n",(0,i.jsx)(s.li,{children:"Nodes can start/stop independently"}),"\n",(0,i.jsx)(s.li,{children:"Easy to add new subscribers"}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"what-is-a-topic",children:"What is a Topic?"}),"\n",(0,i.jsxs)(s.p,{children:["A ",(0,i.jsx)(s.strong,{children:"topic"})," is a named channel for publishing and subscribing to messages."]}),"\n",(0,i.jsx)(s.p,{children:"Think of it like a bulletin board:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Publisher"}),": Posts a message on the board"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Subscribers"}),": Read messages from the board"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Topic Name"}),": The bulletin board label (e.g., ",(0,i.jsx)(s.code,{children:"/temperature"}),")"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Message Type"}),": What data is posted (e.g., ",(0,i.jsx)(s.code,{children:"Float32"}),")"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Key characteristics:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"One-to-many"}),": One publisher, many subscribers"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Asynchronous"}),": Publisher doesn't wait for subscribers"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Typed"}),": Every topic has a message type"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Named"}),": Topics have unique names starting with ",(0,i.jsx)(s.code,{children:"/"})]}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"publishers-and-subscribers",children:"Publishers and Subscribers"}),"\n",(0,i.jsx)(s.h3,{id:"publisher-node",children:"Publisher Node"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"# Creates a publisher\r\npublisher = self.create_publisher(String, '/greeting', 10)\r\n\r\n# Publishes messages\r\nmsg = String()\r\nmsg.data = 'Hello!'\r\npublisher.publish(msg)\n"})}),"\n",(0,i.jsx)(s.h3,{id:"subscriber-node",children:"Subscriber Node"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"# Creates a subscriber with callback\r\nsubscription = self.create_subscription(\r\n    String,\r\n    '/greeting',\r\n    self.listener_callback,\r\n    10\r\n)\r\n\r\n# Callback handles incoming messages\r\ndef listener_callback(self, msg):\r\n    self.get_logger().info(f'Received: {msg.data}')\n"})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"code-example-2-publishersubscriber-system",children:"Code Example 2: Publisher/Subscriber System"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Location"}),": ",(0,i.jsx)(s.code,{children:"code-examples/ros2_packages/pub_sub_py/"})]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Generated by"}),": ",(0,i.jsx)(s.code,{children:"ros2-code-generator"})," skill"]}),"\n",(0,i.jsx)(s.h3,{id:"publisher-node-1",children:"Publisher Node"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"# File: pub_sub_py/pub_sub_py/publisher.py\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\n\r\nclass PublisherNode(Node):\r\n    def __init__(self):\r\n        super().__init__('publisher')\r\n\r\n        # Create a publisher for String messages on /greeting topic\r\n        self.publisher = self.create_publisher(String, '/greeting', 10)\r\n\r\n        # Timer to publish every 1 second\r\n        self.timer = self.create_timer(1.0, self.timer_callback)\r\n        self.i = 0\r\n\r\n    def timer_callback(self):\r\n        # Create and publish message\r\n        msg = String()\r\n        msg.data = f'Hello from publisher: #{self.i}'\r\n        self.publisher.publish(msg)\r\n        self.get_logger().info(f'Publishing: {msg.data}')\r\n        self.i += 1\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = PublisherNode()\r\n    rclpy.spin(node)\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(s.h3,{id:"subscriber-node-1",children:"Subscriber Node"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"# File: pub_sub_py/pub_sub_py/subscriber.py\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\n\r\nclass SubscriberNode(Node):\r\n    def __init__(self):\r\n        super().__init__('subscriber')\r\n\r\n        # Create subscriber that listens to /greeting topic\r\n        # Calls listener_callback when messages arrive\r\n        self.subscription = self.create_subscription(\r\n            String,\r\n            '/greeting',\r\n            self.listener_callback,\r\n            10\r\n        )\r\n\r\n    def listener_callback(self, msg):\r\n        # This function runs when a message arrives\r\n        self.get_logger().info(f'Received: {msg.data}')\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = SubscriberNode()\r\n    rclpy.spin(node)\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"running-a-pubsub-system",children:"Running a Pub/Sub System"}),"\n",(0,i.jsx)(s.h3,{id:"terminal-1-publisher",children:"Terminal 1: Publisher"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ros2 run pub_sub_py publisher\n"})}),"\n",(0,i.jsx)(s.p,{children:"Output:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"[INFO] [publisher]: Publishing: Hello from publisher: #0\r\n[INFO] [publisher]: Publishing: Hello from publisher: #1\r\n[INFO] [publisher]: Publishing: Hello from publisher: #2\n"})}),"\n",(0,i.jsx)(s.h3,{id:"terminal-2-subscriber",children:"Terminal 2: Subscriber"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ros2 run pub_sub_py subscriber\n"})}),"\n",(0,i.jsx)(s.p,{children:"Output:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"[INFO] [subscriber]: Received: Hello from publisher: #0\r\n[INFO] [subscriber]: Received: Hello from publisher: #1\r\n[INFO] [subscriber]: Received: Hello from publisher: #2\n"})}),"\n",(0,i.jsx)(s.h3,{id:"terminal-3-inspect-the-graph",children:"Terminal 3: Inspect the Graph"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"rqt_graph\n"})}),"\n",(0,i.jsx)(s.p,{children:"Visualizes:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"[publisher] --[/greeting]--\x3e [subscriber]\n"})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"topic-naming-conventions",children:"Topic Naming Conventions"}),"\n",(0,i.jsx)(s.p,{children:"ROS 2 topics follow a naming pattern:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"/namespace/subtopic/specific_name\r\n\r\nExamples:\r\n/robot/camera/image        (camera images)\r\n/robot/sensors/imu         (IMU data)\r\n/robot/navigation/goal     (navigation goal)\r\n/system/health/cpu_load    (system metrics)\n"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Best Practices"}),":"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Use lowercase with underscores"}),"\n",(0,i.jsxs)(s.li,{children:["Start with ",(0,i.jsx)(s.code,{children:"/"})]}),"\n",(0,i.jsx)(s.li,{children:"Be specific and descriptive"}),"\n",(0,i.jsx)(s.li,{children:"Group related topics with namespace"}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"message-types",children:"Message Types"}),"\n",(0,i.jsx)(s.p,{children:"Topics carry typed messages. Common types:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"from std_msgs.msg import (\r\n    String,           # Text\r\n    Float32,          # Single floating point\r\n    Int32,            # Integer\r\n    Bool,             # Boolean\r\n    Header,           # Timestamp + frame info\r\n)\r\n\r\nfrom geometry_msgs.msg import (\r\n    Point,            # X, Y, Z coordinates\r\n    Twist,            # Linear and angular velocity\r\n    Pose,             # Position and orientation\r\n)\r\n\r\nfrom sensor_msgs.msg import (\r\n    Image,            # Camera images\r\n    PointCloud2,      # 3D point clouds\r\n    LaserScan,        # LIDAR data\r\n    Imu,              # Inertial measurement unit\r\n)\n"})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"quality-of-service-qos",children:"Quality of Service (QoS)"}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"10"})," parameter in ",(0,i.jsx)(s.code,{children:"create_publisher()"})," and ",(0,i.jsx)(s.code,{children:"create_subscription()"})," is the ",(0,i.jsx)(s.strong,{children:"queue size"})," (QoS):"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"# Queue size: 10 messages\r\nself.publisher = self.create_publisher(String, '/topic', 10)\n"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"What it means"}),":"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"If subscriber is slow, publisher queues up to 10 messages"}),"\n",(0,i.jsx)(s.li,{children:"Older messages are dropped if queue fills"}),"\n",(0,i.jsx)(s.li,{children:"Larger queue = more memory, better for slow subscribers"}),"\n",(0,i.jsx)(s.li,{children:"Smaller queue = faster, better for real-time systems"}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,i.jsx)(s.p,{children:"\u2705 Topics enable one-to-many communication\r\n\u2705 Publishers and subscribers are decoupled\r\n\u2705 Multiple subscribers can listen to one topic\r\n\u2705 Publishers don't wait for subscribers\r\n\u2705 Topics are typed and named\r\n\u2705 QoS settings control message buffering"}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"try-it-yourself",children:"Try It Yourself"}),"\n",(0,i.jsx)(s.p,{children:"Try modifying the pub/sub example:"}),"\n",(0,i.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Change the message text in publisher"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Create a second subscriber (run it in a third terminal)"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Use ",(0,i.jsx)(s.code,{children:"rqt_graph"})," to see multiple subscribers"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Change topic name (must match in both nodes)"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Try ",(0,i.jsx)(s.code,{children:"ros2 topic echo /greeting"})," in another terminal"]}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"next",children:"Next"}),"\n",(0,i.jsxs)(s.p,{children:["Now you understand how nodes communicate via topics. The next pattern is ",(0,i.jsx)(s.strong,{children:"services"}),": synchronous request/response communication."]}),"\n",(0,i.jsxs)(s.p,{children:["\ud83d\udc49 ",(0,i.jsx)(s.strong,{children:"Next"}),": ",(0,i.jsx)(s.a,{href:"/physical-ai-textbook/docs/module-1/ch1-ros2-basics/services",children:"Section 3: Services - Request and Response"})]}),"\n",(0,i.jsx)(s.p,{children:"Or review:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"/physical-ai-textbook/docs/module-1/ch1-ros2-basics/nodes",children:"Section 1: Nodes"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"/physical-ai-textbook/docs/module-1/ch1-ros2-basics/exercises",children:"Exercises"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"/physical-ai-textbook/docs/module-1/ch1-ros2-basics/summary",children:"Summary"})}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Section Status"}),": Complete \u2705\r\n",(0,i.jsx)(s.strong,{children:"Skills Used"}),": ",(0,i.jsx)(s.code,{children:"ros2-code-generator"}),", ",(0,i.jsx)(s.code,{children:"code-explainer"})]})]})}function h(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>c,x:()=>o});var r=n(6540);const i={},l=r.createContext(i);function c(e){const s=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),r.createElement(l.Provider,{value:s},e.children)}}}]);